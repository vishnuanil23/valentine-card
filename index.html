<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For My Valentine ‚ù§Ô∏è</title>

    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Sacramento&family=Baloo+Chettan+2:wght@400;600&display=swap"
        rel="stylesheet">

    <meta property="og:title" content="A Special Valentine Surprise ‚ù§Ô∏è">
    <meta property="og:description" content="I made something special for you üíå Open it!">
    <meta property="og:image" content="https://YOUR_USERNAME.github.io/valentine-card/preview.jpg">
    <meta property="og:type" content="website">

    <style>
        :root {
            --primary: #ff4d6d;
            --bg: linear-gradient(135deg, #fff0f3, #ffccd5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', 'Baloo Chettan 2', sans-serif;
            background: var(--bg);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            perspective: 1000px;
            cursor: none;
        }

        /* Floating Background Hearts */
        .bg-hearts {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            overflow: hidden;
            z-index: 0;
        }

        .bg-heart {
            position: absolute;
            font-size: 20px;
            color: rgba(255, 77, 109, 0.2);
            animation: floatUp linear infinite;
        }

        @keyframes floatUp {
            0% {
                transform: translateY(100vh) scale(.5);
                opacity: 0;
            }

            50% {
                opacity: .6;
            }

            100% {
                transform: translateY(-10vh) scale(1.2);
                opacity: 0;
            }
        }

        /* Custom Heart Cursor */
        .cursor-heart {
            position: fixed;
            width: 22px;
            height: 22px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23ff4d6d' viewBox='0 0 24 24'%3E%3Cpath d='M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z'/%3E%3C/svg%3E");
            background-size: cover;
            pointer-events: none;
            transform: translate(-50%, -50%);
            z-index: 1000;
            animation: pulse 1s infinite alternate;
        }

        @keyframes pulse {
            from {
                transform: translate(-50%, -50%) scale(1);
            }

            to {
                transform: translate(-50%, -50%) scale(1.15);
            }
        }

        /* Trail Hearts */
        .trail-heart {
            position: fixed;
            width: 14px;
            height: 14px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23ff8fa3' viewBox='0 0 24 24'%3E%3Cpath d='M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z'/%3E%3C/svg%3E");
            background-size: cover;
            pointer-events: none;
            animation: trailFade .8s ease-out forwards;
        }

        @keyframes trailFade {
            0% {
                opacity: 1;
                transform: scale(1);
            }

            100% {
                opacity: 0;
                transform: scale(.2) translateY(-20px);
            }
        }

        /* Container */
        .container {
            width: 90%;
            max-width: 420px;
            background: rgba(255, 255, 255, .75);
            backdrop-filter: blur(12px);
            border-radius: 25px;
            padding: 35px 25px;
            text-align: center;
            box-shadow: 0 15px 35px rgba(255, 77, 109, .25);
            transform-style: preserve-3d;
            transition: transform .15s ease;
            z-index: 2;
        }

        h1 {
            font-family: 'Sacramento', cursive;
            color: var(--primary);
            font-size: 2.8rem;
            margin-bottom: 10px;
            transform: translateZ(40px);
        }

        p {
            margin-bottom: 20px;
            color: #444;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        button {
            padding: 14px;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            background: white;
            color: var(--primary);
            cursor: pointer;
            transition: .3s;
        }

        button:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.05);
        }

        .progress-container {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 20px;
        }

        .progress-heart {
            width: 12px;
            height: 12px;
            background-color: #ffd1dc;
            transform: rotate(45deg);
            position: relative;
            transition: 0.3s;
        }

        .progress-heart::before,
        .progress-heart::after {
            content: "";
            width: 12px;
            height: 12px;
            background-color: #ffd1dc;
            border-radius: 50%;
            position: absolute;
            transition: 0.3s;
        }

        .progress-heart::before {
            top: -6px;
            left: 0;
        }

        .progress-heart::after {
            top: 0;
            left: -6px;
        }

        .progress-heart.active {
            background-color: var(--primary);
            transform: rotate(45deg) scale(1.3);
        }

        .progress-heart.active::before,
        .progress-heart.active::after {
            background-color: var(--primary);
        }

        .progress-heart.completed {
            background-color: #ff8fa3;
        }

        .progress-heart.completed::before,
        .progress-heart.completed::after {
            background-color: #ff8fa3;
        }

        .quote-box {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, .85);
            border-radius: 12px;
            font-style: italic;
        }

        .movie {
            margin-top: 8px;
            font-size: .85rem;
            font-weight: 600;
            color: var(--primary);
        }

        .result {
            display: none;
        }

        /* Click Burst */
        .click-heart {
            position: fixed;
            width: 20px;
            height: 20px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23ff4d6d' viewBox='0 0 24 24'%3E%3Cpath d='M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z'/%3E%3C/svg%3E");
            background-size: cover;
            pointer-events: none;
            animation: burst .8s ease forwards;
        }

        @keyframes burst {
            0% {
                transform: translate(0, 0) scale(.5);
                opacity: 1;
            }

            100% {
                transform: translate(var(--tx), var(--ty)) scale(0);
                opacity: 0;
            }
        }
    </style>
</head>

<body>

    <div class="bg-hearts" id="bgHearts"></div>
    <div class="cursor-heart" id="cursorHeart"></div>

    <div class="container" id="card">
        <div id="quiz">
            <div class="progress-container" id="progress"></div>
            <h1 id="header">Hey You!</h1>
            <p id="question">Ready for something special?</p>
            <div class="options" id="options">
                <button onclick="startQuiz()">Start ‚ù§Ô∏è</button>
            </div>
        </div>

        <div id="result" class="result">
            <h1 id="finalTitle"></h1>
            <p>You are officially my favorite person.</p>
            <div class="quote-box">
                <span id="quote"></span>
                <div class="movie" id="movie"></div>
            </div>
            <button onclick="shareCard()">Share ‚ù§Ô∏è</button>
            <button onclick="location.reload()">Restart</button>
        </div>
    </div>

    <script>
        // Floating hearts
        function initHearts() {
            const container = document.getElementById("bgHearts");
            for (let i = 0; i < 20; i++) {
                const h = document.createElement("div");
                h.className = "bg-heart";
                h.innerHTML = "‚ù§";
                h.style.left = Math.random() * 100 + "vw";
                h.style.animationDuration = (10 + Math.random() * 10) + "s";
                h.style.animationDelay = Math.random() * 10 + "s";
                container.appendChild(h);
            }
        }
        initHearts();

        // Heart cursor + trail
        const cursor = document.getElementById("cursorHeart");
        let lastMove = 0;

        document.addEventListener("mousemove", (e) => {
            cursor.style.left = e.clientX + "px";
            cursor.style.top = e.clientY + "px";

            const now = Date.now();
            if (now - lastMove > 40) {
                createTrail(e.clientX, e.clientY);
                lastMove = now;
            }

            // 3D tilt
            const x = (window.innerWidth / 2 - e.pageX) / 30;
            const y = (window.innerHeight / 2 - e.pageY) / 30;
            document.getElementById("card").style.transform =
                `rotateY(${x}deg) rotateX(${y}deg)`;
        });

        function createTrail(x, y) {
            const heart = document.createElement("div");
            heart.className = "trail-heart";
            document.body.appendChild(heart);
            heart.style.left = x + "px";
            heart.style.top = y + "px";
            setTimeout(() => heart.remove(), 800);
        }

        // Click burst
        document.addEventListener("click", (e) => {
            for (let i = 0; i < 10; i++) {
                const heart = document.createElement("div");
                heart.className = "click-heart";
                document.body.appendChild(heart);
                heart.style.left = e.clientX + "px";
                heart.style.top = e.clientY + "px";
                const angle = Math.random() * Math.PI * 2;
                const dist = 50 + Math.random() * 100;
                heart.style.setProperty("--tx", Math.cos(angle) * dist + "px");
                heart.style.setProperty("--ty", Math.sin(angle) * dist + "px");
                setTimeout(() => heart.remove(), 800);
            }
        });

        // Quiz logic
        function getName() {
            // First check query parameters (backward compatibility)
            const params = new URLSearchParams(window.location.search);
            if (params.has("name")) {
                return params.get("name");
            }

            // Then check path
            const path = window.location.pathname;
            // Split by returns and filter out empty strings and common filenames
            const segments = path.split('/').filter(s => s && s !== 'index.html');

            if (segments.length > 0) {
                const lastSegment = segments[segments.length - 1];
                // Avoid treating the repository name as the user name if it's the only segment
                // Adjust 'valentine-card' if your repo name is different
                if (lastSegment !== "valentine-card") {
                    return decodeURIComponent(lastSegment);
                }
            }
            return null;
        }
        const valentineName = getName();

        const questions = [
            { q: "Our aesthetic?", o: ["Retro Sunset üåÖ", "Midnight Rain üåßÔ∏è", "Golden Hour ‚ú®"] },
            { q: "The vibe of our first meeting?", o: ["Slow Motion", "A Blur", "Written in the stars"] },
            { q: "Your favorite 'us' moment?", o: ["Comfortable Silence", "Inside Jokes", "Unexpected Hugs"] },
            { q: "Who is the 'Safe Space'?", o: ["You üè†", "Me üè†", "We are each other's"] },
            { q: "If we were a song?", o: ["Indie Soul", "Classic Melody", "Lofi Beats"] },
            { q: "What's my 'Tell'?", o: ["The Eyes", "The Smile", "The Voice"] },
            { q: "Our love language?", o: ["Deep talks", "Random gifts", "Just being there"] },
            { q: "The best part of 'You'?", o: ["Your heart", "Your chaos", "Everything"] }
        ];

        const quotes = [
            // { t: "You have bewitched me, body and soul.", m: "Pride & Prejudice (2005)" },
            { t: "I would rather share one lifetime with you than face all the ages of this world alone.", m: "Lord of the Rings (2001)" },
            // { t: "I think I'd miss you even if we'd never met.", m: "The Wedding Date (2005)" },
            { t: "Everything I have ever done, I've done for you.", m: "Great Expectations (1998)" },
            // { t: "You are my greatest adventure.", m: "The Incredibles (2004)" },
            { t: "‡¥®‡¥Æ‡µÅ‡¥ï‡µç‡¥ï‡µç ‡¥ó‡µç‡¥∞‡¥æ‡¥Æ‡¥ô‡µç‡¥ô‡¥≥‡¥ø‡µΩ ‡¥ö‡µÜ‡¥®‡µç‡¥®‡µÅ ‡¥∞‡¥æ‡¥™‡µç‡¥™‡¥æ‡µº‡¥ï‡µç‡¥ï‡¥æ‡¥Ç; ‡¥Ö‡¥§‡¥ø‡¥ï‡¥æ‡¥≤‡¥§‡µç‡¥§‡µç ‡¥é‡¥¥‡µÅ‡¥®‡µç‡¥®‡µá‡¥±‡µç‡¥±‡µç ‡¥Æ‡µÅ‡¥®‡µç‡¥§‡¥ø‡¥∞‡¥ø‡¥§‡µç‡¥§‡µã‡¥ü‡µç‡¥ü‡¥ô‡µç‡¥ô‡¥≥‡¥ø‡µΩ ‡¥™‡µã‡¥Ø‡¥ø ‡¥Æ‡µÅ‡¥®‡µç‡¥§‡¥ø‡¥∞‡¥ø‡¥µ‡¥≥‡µç‡¥≥‡¥ø ‡¥§‡¥≥‡¥ø‡µº‡¥§‡µç‡¥§‡µÅ ‡¥™‡µÇ‡¥µ‡¥ø‡¥ü‡µÅ‡¥ï‡¥Ø‡µÅ‡¥Ç ‡¥Æ‡¥æ‡¥§‡¥≥‡¥®‡¥æ‡¥∞‡¥ï‡¥Ç ‡¥™‡µÇ‡¥ï‡µç‡¥ï‡µÅ‡¥ï‡¥Ø‡µÅ‡¥Ç ‡¥ö‡µÜ‡¥Ø‡µç‡¥§‡µÅ‡¥µ‡µã ‡¥é‡¥®‡µç‡¥®‡µç ‡¥®‡µã‡¥ï‡µç‡¥ï‡¥æ‡¥Ç. ‡¥Ö‡¥µ‡¥ø‡¥ü‡µÜ ‡¥µ‡µÜ‡¥ö‡µç‡¥ö‡µç ‡¥û‡¥æ‡µª ‡¥®‡¥ø‡¥®‡¥ï‡µç‡¥ï‡µç ‡¥é‡¥®‡µç‡¥±‡µÜ ‡¥™‡µç‡¥∞‡µá‡¥Æ‡¥Ç ‡¥§‡¥∞‡µÅ‡¥Ç.", m: "Namukku Parkkan Munthirithoppukal (1986)" },
            { t: "‡¥®‡¥Æ‡µÅ‡¥ï‡µç‡¥ï‡µç ‡¥™‡µç‡¥∞‡¥£‡¥Ø‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡µª ‡¥í‡¥∞‡µÅ ‡¥®‡¥ó‡¥∞‡¥Ç ‡¥µ‡µá‡¥£‡¥Æ‡µÜ‡¥®‡µç‡¥®‡µä‡¥®‡µç‡¥®‡µÅ‡¥Æ‡¥ø‡¥≤‡µç‡¥≤... ‡¥®‡¥ø‡¥®‡µç‡¥±‡µÜ ‡¥ï‡¥£‡µç‡¥£‡µç ‡¥Æ‡¥æ‡¥§‡µç‡¥∞‡¥Ç ‡¥Æ‡¥§‡¥ø.", m: "Godha (2017)" },
            { t: "‡¥ú‡µÄ‡¥µ‡¥ø‡¥§‡¥§‡µç‡¥§‡¥ø‡µΩ ‡¥ö‡¥ø‡¥≤ ‡¥ï‡¥æ‡¥∞‡µç‡¥Ø‡¥ô‡µç‡¥ô‡µæ ‡¥Ö‡¥ô‡µç‡¥ô‡¥®‡µÜ‡¥Ø‡¥æ‡¥£‡µç... ‡¥é‡¥§‡µç‡¥∞ ‡¥µ‡µà‡¥ï‡¥ø‡¥Ø‡¥æ‡¥≤‡µÅ‡¥Ç ‡¥Ö‡¥§‡µç ‡¥®‡¥Æ‡µç‡¥Æ‡¥≥‡µÜ ‡¥§‡µá‡¥ü‡¥ø ‡¥é‡¥§‡µç‡¥§‡µÅ‡¥Ç.", m: "Om Shanti Oshana (2014)" },
            { t: "‡¥®‡µÄ‡¥Ø‡¥æ‡¥£‡µç ‡¥é‡¥®‡µç‡¥±‡µÜ ‡¥≤‡µã‡¥ï‡¥Ç", m: "Premam (2015)" },
        ];

        let current = 0;
        let lastQuote = -1;

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function startQuiz() {
            const lastQ = questions.pop();
            shuffle(questions);
            questions.push(lastQ);
            current = 0;
            nextQuestion();
        }

        function nextQuestion() {
            if (current < questions.length) {
                const q = questions[current];
                document.getElementById("header").innerText = `Question ${current + 1}`;
                document.getElementById("question").innerText = "Hmm‚Ä¶ interesting üëÄ";
                document.getElementById("options").innerHTML = "";

                // Update Progress Hearts
                const progressContainer = document.getElementById("progress");
                progressContainer.innerHTML = "";
                questions.forEach((_, index) => {
                    const heart = document.createElement("div");
                    heart.className = "progress-heart";
                    if (index < current) heart.classList.add("completed");
                    if (index === current) heart.classList.add("active");
                    progressContainer.appendChild(heart);
                });

                setTimeout(() => {
                    document.getElementById("question").innerText = q.q;
                    q.o.forEach(opt => {
                        const btn = document.createElement("button");
                        btn.innerText = opt;
                        btn.onclick = () => { current++; nextQuestion(); };
                        document.getElementById("options").appendChild(btn);
                    });
                }, 600);
            } else showResult();
        }

        function showResult() {
            document.getElementById("quiz").style.display = "none";
            document.getElementById("result").style.display = "block";

            let r;
            do { r = Math.floor(Math.random() * quotes.length); }
            while (r === lastQuote);
            lastQuote = r;

            const selected = quotes[r];
            const nameText = valentineName ? `, ${valentineName}` : "";
            document.getElementById("finalTitle").innerText =
                `Happy Valentine's${nameText}! ‚ù§Ô∏è`;
            document.getElementById("quote").innerText = `"${selected.t}"`;
            document.getElementById("movie").innerText = `- ${selected.m}`;
        }

        async function shareCard() {
            const card = document.getElementById("card");
            const buttons = document.querySelectorAll("#result button");
            const shareBtn = buttons[0];
            const restartBtn = buttons[1];

            // Hide buttons temporarily
            shareBtn.style.display = "none";
            restartBtn.style.display = "none";

            // Capture card
            const canvas = await html2canvas(card, {
                scale: 2,
                backgroundColor: null
            });

            // Restore buttons
            shareBtn.style.display = "inline-block";
            restartBtn.style.display = "inline-block";

            canvas.toBlob(async function (blob) {
                const file = new File([blob], "valentine-card.png", { type: "image/png" });

                if (navigator.canShare && navigator.canShare({ files: [file] })) {
                    await navigator.share({
                        files: [file],
                        title: "Happy Valentine's ‚ù§Ô∏è",
                        text: "Made just for you üíå"
                    });
                } else {
                    // Fallback: download image
                    const link = document.createElement("a");
                    link.href = canvas.toDataURL();
                    link.download = "valentine-card.png";
                    link.click();
                }
            });
        }

    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</body>

</html>